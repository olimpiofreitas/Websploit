require_relative '../../core/base_module'

module Websploit
  class SqlInjection < Websploit::BaseModule
    path 'exploit/sql_injection'

    register_option 'TARGET', default: '', required: true, description: 'Target URL'
    register_option 'PARAM', default: 'id', required: false, description: 'Parameter to test'
    register_option 'METHOD', default: 'GET', required: false, description: 'HTTP Method (GET/POST)'

    def run
      target = options["TARGET"][:current]
      param = options["PARAM"][:current]
      method = options["METHOD"][:current]

      puts "[*] Testing SQL injection on #{target}"
      puts "[*] Parameter: #{param}"
      puts "[*] Method: #{method}"
      # Implementação do exploit aqui
    end
  end
end 